# Image Tracking
## Naive approach
對於單點$(x,y)$來說，每個timestamp產生一個$(x,y)$，如此一來形成一個array，也可以說是函數$$C_{k}~~where~~k=1,2,3,...t$$
若
$$\frac{dc}{dt}<\epsilon$$
則為連續(即連續的定義)
Problem : 上述定義只能解決等速率時的情況，若單體具有加速度，就爆了，若每個出現在畫面中的單體，有不同的速率，同樣的爆了，因為不知道$\epsilon$怎麼定。

## kalman filtering
用於物件追蹤，雷達，軌道預測，kalman在196x年發表，用來解決火箭軌道預測的問題
核心思想主要加入了Bayesian inference，搭配物理學的運動公式，來推論下一個時間點可能的位置

#### 用途
存在不確定訊息的動態系統，kalman filtering可以針對系統的下一步要做什麼做出有根據的推測，即便有噪聲訊息干擾。

#### 優點與缺點 

優點 : 記憶體佔用小，速度快
缺點 : fine tune之後，或許精準度不夠高，因為只用了一階微分來逼近，maybe加入二階微分

#### 概念與數學

##### Introduction
一個可以在樹林裡四處閒逛的小機器人，為了實現導航，**機器人需要知道自己所在的位置**

機器人會有一個包含位置以及速度訊息的狀態$x_{k}$，$x$是一個$n$維度的向量，或說矩陣
$$
x_{k} = (p, v)
$$
其中$p$存放位置資訊，可能有1~3個維度，$v$ 存放速度資訊，可能有1~3個維度，與$p$具有相同維度

* 我們可以透過GPS傳感器，得知機器人位置，有定位精度的問題，我們只能知道個大概，**所以GPS提供的資訊無法足夠精準**

* 我們可以預測機器人的移動，透過控制馬達，但是控制馬達並不代表他的速度，因為可能**逆風行駛**，**輪子打滑**，**滾落顛波地形**，所以根據控制馬達的預測也無法完美

* 在**如此多外部因素**的情況下，我們能夠足夠精準的預測機器人的位置?
* 答案就是卡曼濾波

> 思考點 : 如果外部因素不會很多，例如風阻小，穩定的運動軌跡，追蹤點不會突然消失等等，我們只要有**位置**，**速度**，**加速度**，就能夠足夠準確的預測物體軌跡，所以只有在**外部因素多的時候**，加入bayesian inference的思想，進行推論，我們就不用一一計算各個外部因素帶來的影響

<img src='/images/kalman_1.png'></img>

* 暫時地，我們先假設位置$p$與速度$v$沒有相關性(這當然是不對的，我們後面可以修正回來)，並且只看一個維度
<img src='/images/kalman_2.png'></img>
* kalman filtering假設的兩個變量(as a vector)都應該是**隨機的**，並且符合**高斯分佈**，在這樣的前提下，每個變量都有一個均值$\mu$，以及一個方差$\sigma^{2}$用來描述隨機分佈的中心以及組合的不確定性
* 不過按照物理學的知識，位置和速度具有公式關係，換句話說，相關係數是1，我們有了速度，瞭解上一步的位置的情況下，且運動物體是等速前進的，我們就能夠推論位置，換句話說，在這樣的情況下相關係數是1
<img src='/images/kalman_3.png'></img>

* 從統計的觀點來看上述的圖形，我們可以說 : 在外部因素的情況下，雖然有速度無法100%精確的預測接下來的位置，但是有足夠高的相關性幫助我們縮小接下來可能的位置範圍，或許是一個區間估計
* 而我們怎麼使用這個高度相關性的物理量呢? 統計上使用Covariance matrix來捕捉correlation
$$
Covariance~matrix~= \Sigma_{ij}
$$
在此例子中, $i,j=1$表示位置, $i,j=2$表示速度，$\Sigma_{ij}$是一個對稱，且semi positive(半正定)矩陣
<img src='/images/kalman_4.png'></img>

##### 用矩陣描述問題
在$k$時刻下 : 
最佳估計值$\hat{x}$以及Covariance Matrix $P_{k}$
$$
\hat{x_{k}} = {position \brack velocity}
P_{k} = {\Sigma_{pp}~\Sigma_{pv} \brack \Sigma_{vp}~\Sigma_{vv}}
$$
? 這裡的$\hat{x_{k}}$是否是$x_{k}$？還是一個是預測一個是True?





#### Tuning


#### 實作

#### 其他應用
狀態$x$可以放的是位置與速度，但是也可以放液體體積，引擎溫度，觸摸板上指標的位置，或是其他數據，基本上配上一個一階微分的物理量

#### Math 
(semi-positive) 半正定矩陣 : 
